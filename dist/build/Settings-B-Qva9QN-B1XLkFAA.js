import{x as M,y as I,z as P,A as y,d as E,G as r,g as R,u as j,h as F,j as e,P as x,M as L,r as k,i as B,k as T,H as v,J as C,b as w,K as $,N as H,B as N,F as O,T as U,O as f,Q as V,S as z,l as G,U as Q}from"./strapi-B5tTVWvh.js";import{u as q,c as _,g as n}from"./getTrad-BzQMnOxD-DVNgP35m.js";const D=t=>t.name!==void 0,J=M().shape({restrictedAccess:I(),password:P().when("restrictedAccess",(t,o)=>t?o.required(y.required.id).min(8).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"):o)}),K=E(r.Action)`
  svg {
    height: 1.6rem;
    width: 1.6rem;
    path {
      fill: ${({theme:t})=>t.colors.neutral600};
    }
  }
`,W=({data:t,onSubmit:o})=>{const{formatMessage:s}=j(),[c,l]=k.useState(!1),{allowedActions:g}=B(T);return e.jsx(v,{enableReinitialize:!0,initialValues:{restrictedAccess:t?.documentationAccess.restrictedAccess||!1,password:""},onSubmit:o,validationSchema:J,children:({handleSubmit:u,values:a,handleChange:p,errors:i,setFieldTouched:h,setFieldValue:m,setFieldError:d,dirty:A})=>e.jsxs(C,{noValidate:!0,onSubmit:u,children:[e.jsx(w.Header,{title:s({id:n("plugin.name"),defaultMessage:"Documentation"}),subtitle:s({id:n("pages.SettingsPage.header.description"),defaultMessage:"Configure the documentation plugin"}),primaryAction:e.jsx($,{type:"submit",startIcon:e.jsx(H,{}),disabled:!A&&g.canUpdate,children:s({id:n("pages.SettingsPage.Button.save"),defaultMessage:"Save"})})}),e.jsx(w.Content,{children:e.jsx(N,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:e.jsxs(O,{direction:"column",alignItems:"stretch",gap:4,children:[e.jsx(U,{variant:"delta",tag:"h2",children:s({id:"global.settings",defaultMessage:"Settings"})}),e.jsxs(f.Root,{gap:4,children:[e.jsx(f.Item,{col:6,s:12,direction:"column",alignItems:"stretch",children:e.jsxs(r.Root,{name:"restrictedAccess",hint:s({id:n("pages.SettingsPage.toggle.hint"),defaultMessage:"Make the documentation endpoint private"}),children:[e.jsx(r.Label,{children:s({id:n("pages.SettingsPage.toggle.label"),defaultMessage:"Restricted Access"})}),e.jsx(V,{checked:a.restrictedAccess,onChange:()=>{a.restrictedAccess===!0&&(m("password","",!1),h("password",!1,!1),d("password",void 0)),m("restrictedAccess",!a.restrictedAccess,!1)},onLabel:"On",offLabel:"Off"}),e.jsx(r.Hint,{})]})}),a.restrictedAccess&&e.jsx(f.Item,{col:6,s:12,direction:"column",alignItems:"stretch",children:e.jsxs(r.Root,{name:"password",error:i.password?s({id:i.password,defaultMessage:i.password}):void 0,children:[e.jsx(r.Label,{children:s({id:"global.password",defaultMessage:"Password"})}),e.jsx(z,{placeholder:"**********",type:c?"text":"password",value:a.password,onChange:p,endAction:e.jsx(K,{onClick:S=>{S.stopPropagation(),l(b=>!b)},label:s(c?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:c?e.jsx(G,{}):e.jsx(Q,{})})}),e.jsx(r.Error,{})]})})]})]})})})]})})},Y=()=>{const{toggleNotification:t}=R(),{formatMessage:o}=j(),{_unstableFormatAPIError:s,_unstableFormatValidationErrors:c}=F(),{data:l,isError:g,isLoading:u,isFetching:a}=q(),[p]=_(),i=async(h,m)=>p({body:h}).unwrap().then(()=>{t({type:"success",message:o({id:n("notification.update.success"),defaultMessage:"Successfully updated settings"})})}).catch(d=>{D(d)&&d.name==="ValidationError"&&t({type:"danger",message:s(d)})});return u||a?e.jsx(x.Loading,{}):g?e.jsx(x.Error,{}):e.jsx(L,{children:e.jsx(W,{data:l,onSubmit:i})})};export{Y as SettingsPage};
